
import fs from 'fs';
import path from 'path';
import { app } from 'electron';

export default {
	readSettingsFile( fileName, next ) {
		let filePath = path.join( app.getPath( 'userData' ), fileName );
		fs.readFile( filePath, 'utf8', next );
	},

	writeSettingsFile( fileName, contents, next ) {
		let filePath = path.join( app.getPath( 'userData' ), fileName );
		fs.writeFile( filePath, contents, next );
	},

	readServers( next ) {
		this.readSettingsFile( 'servers.json', ( error, serversText ) => {
			if( error ) {
				if( error.code == 'ENOENT' ) {
					return next( null, [] );
				}

				return next( error );
			}

			return next( null, JSON.parse( serversText ) );
		});
	},

	writeServers( servers, next ) {
		this.writeSettingsFile( 'servers.json', JSON.stringify( servers ), next );
	}
}